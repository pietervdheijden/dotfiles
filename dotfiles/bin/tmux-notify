#!/bin/bash
TITLE="$1"
BODY="$2"

CLIENT_TTY=$(tmux display-message -p '#{client_tty}')
PANE_TTY=$(tmux display-message -t "$TMUX_PANE" -p '#{pane_tty}')

# Send notification directly to Kitty via client TTY
kitten notify --only-print-escape-code "$TITLE" "$BODY" > "$CLIENT_TTY"

# Bell for audio notification
printf '\a' > "$PANE_TTY"

# Save pane ID for focus-on-click via tmux hook
echo "$TMUX_PANE" > /tmp/tmux-notify-pane
(sleep 300 && rm -f /tmp/tmux-notify-pane) &>/dev/null &
